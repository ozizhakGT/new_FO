<div class="general-wrapper" *ngIf="userState | async">
  <mat-card class="form-wrapper" [ngClass]="{'blur': spinner}">
    <h2>Payments Methods</h2>
    <form [formGroup]="paymentmethodsForm" (ngSubmit)="onUpdatePaymentMethod(paymentmethodsForm)">
      <div>
        <mat-form-field>
          <mat-label>Payment Options</mat-label>
          <mat-select formControlName='payment_method'>
            <mat-option *ngFor="let method of paymentsMethodOption" [value]="method.id">
              {{method.type}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="divide-line"></div>
      <div *ngIf="paymentmethodsForm.value.payment_method !== 2">
        <mat-form-field>
          <input matInput type="email" formControlName='payment_email' placeholder="Email For Payment" email>
        </mat-form-field>
      </div>
      <div *ngIf="paymentmethodsForm.value.payment_method === 2">
        <div>
          <mat-form-field>
            <input matInput type="text" formControlName='beneficiary_name' placeholder="Beneficiary Name">
          </mat-form-field>
          <mat-form-field>
            <input matInput type="text" formControlName='beneficiary_address' placeholder="Beneficiary Address">
          </mat-form-field>
        </div>
        <div>
          <mat-form-field>
            <input matInput type="text" formControlName='bank_name' placeholder="Bank Name">
          </mat-form-field>
          <mat-form-field>
            <input matInput type="text" formControlName='bank_address' placeholder="Bank Address">
          </mat-form-field>
        </div>
        <div>
          <mat-form-field>
            <input matInput type="text" formControlName='swift_code' placeholder="Swift Code">
          </mat-form-field>
          <mat-form-field>
            <input matInput type="text" formControlName='iban_number' placeholder="IBAN Number">
          </mat-form-field>
        </div>
        <div>
          <mat-form-field>
            <input matInput type="text" formControlName='account_number' placeholder="Account Number">
          </mat-form-field>
          <mat-form-field>
            <mat-label>Payment Options</mat-label>
            <mat-select formControlName='payment_period'>
              <mat-option *ngFor="let type of paymentPeriodOption" [value]="type">
                {{type}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div>
          <mat-form-field class="comments-textarea">
            <textarea matInput #comment formControlName="comment" matTextareaAutosize="true" maxlength="256" placeholder="Leave a comment"></textarea>
            <mat-hint align="end">{{comment.value?.length || 0}}/256</mat-hint>
          </mat-form-field>
        </div>
      </div>
      <button mat-raised-button type="submit" color="primary">Update Payment Method</button>
    </form>
    <div *ngIf="spinner" class="block-form">
      <mat-spinner [diameter]="30" class="form-spinner"></mat-spinner>
    </div>
  </mat-card>
  <mat-card>
    <h2>Payments History</h2>
    <table mat-table [dataSource]="paymentsHistory" class="mat-elevation-z8">

      <ng-container matColumnDef='0'>
        <th mat-header-cell *matHeaderCellDef> Date Changed </th>
        <td mat-cell *matCellDef="let element"> {{element.changed_date}} </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </mat-card>
</div>
